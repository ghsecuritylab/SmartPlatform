SET(CMAKE_SYSTEM_PROCESSOR cortex-m4)

ADD_DEFINITIONS(-D__STARTUP_COPY_MULTIPLE)
ADD_DEFINITIONS(-D__STARTUP_CLEAR_BSS_MULTIPLE)
ADD_DEFINITIONS(-D__NO_SYSTEM_INIT)
ADD_DEFINITIONS(-DSTM32F407xx)

INCLUDE_DIRECTORIES(${STM32_PLATFORM_TOP}/board/CMSIS/Include)
INCLUDE_DIRECTORIES(${STM32_PLATFORM_TOP}/board/CMSIS/Device/Include)
INCLUDE_DIRECTORIES(${STM32_PLATFORM_TOP}/board/STM32F4xx_HAL_Driver/Inc)
INCLUDE_DIRECTORIES(${STM32_PLATFORM_TOP}/board/${STM32_PLATFORM_BOARD_NAME})

AUX_SOURCE_DIRECTORY(${STM32_PLATFORM_TOP}/board/STM32F4xx_HAL_Driver/Src SRC_LIST)
AUX_SOURCE_DIRECTORY(${STM32_PLATFORM_TOP}/board/CMSIS/Device/Source SRC_LIST)

IF(STM32_PLATFORM_USE_FREERTOS STREQUAL "true")
    INCLUDE(${STM32_PLATFORM_TOP}/cmake/rtos-freertos.cmake)
ENDIF()